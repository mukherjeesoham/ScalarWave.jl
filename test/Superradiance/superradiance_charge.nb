(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     66234,       1493]
NotebookOptionsPosition[     61813,       1414]
NotebookOutlinePosition[     62191,       1431]
CellTagsIndexPosition[     62148,       1428]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 StyleBox[Cell[TextData[{
   "Amplification factors for charged bosonic waves in a BH Background\n",
   StyleBox[
   "Reference: Richard Brito, Vitor Cardoso and Paolo Pani, \
\[OpenCurlyDoubleQuote]Black-hole superradiance: from fundamental physics to \
astrophysics\[CloseCurlyDoubleQuote] (2015)",
    FontSize->12]
  }], "Subtitle",
   CellChangeTimes->{
    3.5701092341113586`*^9, {3.570117652780466*^9, 3.5701176573116493`*^9}, {
     3.570118625235464*^9, 3.5701186769267683`*^9}, {3.570227375137948*^9, 
     3.570227401005803*^9}, {3.571072184950651*^9, 3.571072199211156*^9}, {
     3.571072309951724*^9, 3.571072360711537*^9}, 3.5710725997199793`*^9, {
     3.571072634393869*^9, 3.571072695533065*^9}},ExpressionUUID->
   "010233bd-1ee0-4d81-8d16-cc4732bcc8fe"],
  FontSize->12]], "Subtitle",
 CellChangeTimes->{{3.604390909950038*^9, 3.604390998156616*^9}, {
  3.615112696921135*^9, 3.615112706232522*^9}, {3.629782461712901*^9, 
  3.629782491415793*^9}},ExpressionUUID->"f58bf81e-dccc-4b3f-91c2-\
9a379a3b2025"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.5618067920581937`*^9, {3.5865017409778147`*^9, 3.586501743259158*^9}, 
   3.6050903815438128`*^9},
 CellLabel->
  "In[285]:=",ExpressionUUID->"fbea81b3-95c1-4593-99f5-0aeab965045a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.605090522516127*^9, 3.605090542086317*^9}, {
  3.605090578271559*^9, 
  3.605090578467682*^9}},ExpressionUUID->"d706f32d-4108-4795-b83d-\
ea58928e904e"],

Cell[CellGroupData[{

Cell["Equation", "Section",
 CellChangeTimes->{{3.5618068892031937`*^9, 3.5618068969081936`*^9}, {
  3.6041446104155717`*^9, 3.6041446109859495`*^9}, {3.6043906749960036`*^9, 
  3.60439067643696*^9}, {3.6043910238266635`*^9, 3.604391026525456*^9}, {
  3.6043918908009343`*^9, 3.6043919014269915`*^9}, {3.615112812645067*^9, 
  3.615112815236259*^9}},ExpressionUUID->"e8a5b82e-6368-4394-9129-\
98c578762f0f"],

Cell["\<\
Here we write the Schr\[ODoubleDot]dinger-like equation. In principle any \
kind of perturbation in different theories can be set in this form, just \
changing the potential and the metric coefficients. In this example we \
specialize to D=4 Reissner-Nordstrom BHs and a massless charged scalar.\
\>", "Text",
 CellChangeTimes->{{3.571076995821969*^9, 3.571077029156901*^9}, {
   3.6043907092757697`*^9, 3.604390816378897*^9}, {3.615122848244548*^9, 
   3.615122909611393*^9}, 
   3.750077136044559*^9},ExpressionUUID->"91378cea-906e-44bc-98d5-\
2e8e03c5522c"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.5688159179286947`*^9, 3.568815923463686*^9}, {
  3.605091664828166*^9, 3.6050916681349573`*^9}, {3.615112828919792*^9, 
  3.6151128321593857`*^9}},ExpressionUUID->"568d008f-55d3-4a08-8fdc-\
ab98b09186d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", ">", "0"}], ",", 
      RowBox[{"a", ">", " ", "0"}], ",", 
      RowBox[{"r", ">", "0"}], ",", 
      RowBox[{"a", "<", "M"}], ",", 
      RowBox[{"\[Omega]", ">", "0"}], ",", 
      RowBox[{"Q", "<", "M"}], ",", 
      RowBox[{"q", ">", "0"}], ",", 
      RowBox[{"Q", ">", "0"}], ",", 
      RowBox[{"r", ">", 
       RowBox[{"M", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M", "2"], "-", 
          SuperscriptBox["Q", "2"]}]]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", 
     RowBox[{"M", "/", "r"}]}], "+", 
    RowBox[{
     RowBox[{"Q", "^", "2"}], "/", 
     RowBox[{"r", "^", "2"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"B", "[", "r_", "]"}], ":=", 
   RowBox[{"f", "[", "r", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"om", "[", "r_", "]"}], ":=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"l", " ", 
      RowBox[{"(", 
       RowBox[{"l", "+", "1"}], ")"}]}], 
     SuperscriptBox["r", "2"]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"f", "'"}], "[", "r", "]"}], "r"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{"M", "+", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["M", "2"], "-", 
      SuperscriptBox["Q", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rm", "=", 
   RowBox[{"M", "-", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["M", "2"], "-", 
      SuperscriptBox["Q", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], "-", 
       FractionBox[
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"om", "[", "r", "]"}], " ", "\[Omega]"}], 
        SuperscriptBox["r", "2"]], "-", 
       RowBox[{
        RowBox[{"f", "[", "r", "]"}], " ", "U"}]}], ")"}], "-", " ", 
     FractionBox[
      RowBox[{"2", "q", " ", "Q", " ", "\[Omega]"}], "r"], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["q", "2"], 
       SuperscriptBox["Q", "2"]}], 
      SuperscriptBox["r", "2"]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "**)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6151127220517693`*^9, 3.61511272286732*^9}, {
   3.615112762843349*^9, 3.615112822756115*^9}, {3.615112968757729*^9, 
   3.6151130362578907`*^9}, 3.615113089864503*^9, {3.615113211134224*^9, 
   3.615113281088813*^9}, {3.615113882481916*^9, 3.6151138896003428`*^9}, {
   3.615115251389509*^9, 3.6151152615529833`*^9}, {3.615115559577022*^9, 
   3.615115585774819*^9}, {3.6151160158254128`*^9, 3.615116017630616*^9}, {
   3.61511647397613*^9, 3.615116474500798*^9}, {3.6151165178095913`*^9, 
   3.615116517929885*^9}, {3.615116825377366*^9, 3.61511682992264*^9}, 
   3.61511702964894*^9, {3.61512293093262*^9, 3.6151229350581636`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"36589d43-89a9-40f5-8ad5-bb944dab06c9"],

Cell[TextData[{
 "To avoid complications, we prescribe ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kH", "=", 
    SqrtBox[
     RowBox[{"V", "(", "rp", ")"}]]}], TraditionalForm]],ExpressionUUID->
  "848b77df-e6b6-49c0-b78c-383042363960"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"kinf", "=", 
    SqrtBox[
     RowBox[{"V", "(", "infinity", ")"}]]}], TraditionalForm]],
  ExpressionUUID->"04acb258-737c-4d9f-8c1b-b757ef67f654"],
 " and the tortoise coordinate:"
}], "Text",
 CellChangeTimes->{{3.615122940381751*^9, 3.615122982624045*^9}, {
  3.750810835281385*^9, 
  3.75081083616792*^9}},ExpressionUUID->"b3d25c19-0e9f-4ac6-beda-\
aeb026e471c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kH", "=", 
   RowBox[{"\[Omega]", "-", 
    FractionBox[
     RowBox[{"q", " ", "Q"}], 
     RowBox[{"M", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["M", "2"], "-", 
        SuperscriptBox["Q", "2"]}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kinf", "=", "\[Omega]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "r_", "]"}], ":=", 
   RowBox[{"r", "+", 
    RowBox[{"M", " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "-", "rp"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"r", "-", "rm"}], ")"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["M", "2"]}], "-", 
       SuperscriptBox["Q", "2"]}], 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["M", "2"], "-", 
         SuperscriptBox["Q", "2"]}]]}]], " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"r", "-", "rp"}], 
       RowBox[{"r", "-", "rm"}]], "]"}]}]}]}], ";"}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"28400796-6a76-46cd-80c6-02bc99921d44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Equations and Series",
 StyleBox["    [no need to run this if the external file has been already \
generated]", "Subsubsection"]
}], "Subsection",
 CellChangeTimes->{{3.60509167298256*^9, 3.6050917138913794`*^9}, {
  3.605091762160078*^9, 
  3.605091769588382*^9}},ExpressionUUID->"ed151953-4d2b-4bef-90d3-\
9b8be778124f"],

Cell[CellGroupData[{

Cell["Wave equation", "Subsubsection",
 CellChangeTimes->{{3.5618068892031937`*^9, 3.5618068969081936`*^9}, {
   3.6043918556075625`*^9, 3.6043918601916075`*^9}, 
   3.615113955315243*^9},ExpressionUUID->"73ac825d-a349-4d5b-a4f4-\
a582ba27ca21"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "rs", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqn", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", "r", "]"}], " ", 
       RowBox[{"B", "[", "r", "]"}], " ", 
       RowBox[{
        RowBox[{"\[Psi]", "''"}], "[", "r", "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"B", "'"}], "[", "r", "]"}], " ", 
          RowBox[{"f", "[", "r", "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "'"}], "[", "r", "]"}], " ", 
          RowBox[{"B", "[", "r", "]"}]}]}], ")"}], " ", 
       RowBox[{
        RowBox[{"\[Psi]", "'"}], "[", "r", "]"}]}], "+", 
      RowBox[{"V", " ", 
       RowBox[{"\[Psi]", "[", "r", "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.615112779796966*^9, 3.615112966836751*^9, 3.6151139553172626`*^9, {
   3.6151155419504747`*^9, 3.615115543561537*^9}, {3.6151159809381733`*^9, 
   3.615115981535269*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"673ce1d2-e4e5-4ca1-8bc3-1324ff7e550e"],

Cell["Transformation:", "Text",
 CellChangeTimes->{{3.61512299552526*^9, 
  3.615122999425191*^9}},ExpressionUUID->"1aa09325-0354-4adb-907f-\
f1eeaf2745b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", "k", " ", 
      RowBox[{"rs", "[", "r", "]"}]}], "]"}], 
    RowBox[{"h", "[", "r", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqS", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      FractionBox["eqn", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"rs", "[", "r", "]"}]}]]], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"rs", "'"}], "[", "r", "]"}], "\[Rule]", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          RowBox[{"f", "[", "r", "]"}], 
          RowBox[{"B", "[", "r", "]"}]}]]]}]}], "/.", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"rs", "'"}], "[", "r", "]"}], "\[Rule]", 
        FractionBox["1", 
         SqrtBox[
          RowBox[{
           RowBox[{"f", "[", "r", "]"}], 
           RowBox[{"B", "[", "r", "]"}]}]]]}], ",", "r"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Psi]", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.615113835240239*^9, 3.615113868793889*^9}, {
   3.615113903062155*^9, 3.615113959550774*^9}, 3.615113999835473*^9, 
   3.615123003853024*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"1ae5b8f4-b930-411f-8f38-9d6ee42e8b9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Series Horizon (this can take some time)", "Subsubsection",
 CellChangeTimes->{{3.5618068892031937`*^9, 3.5618068969081936`*^9}, {
  3.6041446202891245`*^9, 3.604144623524276*^9}, {3.604392064963597*^9, 
  3.6043920721954*^9}, {3.604392625348751*^9, 
  3.6043926346629353`*^9}},ExpressionUUID->"f078b389-1aaa-4edc-af11-\
74fc324044b2"],

Cell["\<\
Here we do the standard series expansion at the horizon. (The order of the \
expansion, ORDH, can be set freely)\
\>", "Text",
 CellChangeTimes->{{3.571076995821969*^9, 3.571077029156901*^9}, 
   3.6043906853999133`*^9},ExpressionUUID->"ccd756d5-58a2-47b7-b416-\
f8e42c7c7bd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ORDH", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqSH", "=", 
   RowBox[{"eqS", "/.", 
    RowBox[{"k", "\[Rule]", 
     RowBox[{"-", "kH"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"h", "[", "r_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"hh", "[", "i", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "-", "rp"}], ")"}], "i"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "ORDH"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleH", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"eqSH", "//.", "ruleH"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "rp", ",", "ORDH"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqsH", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeriesCoefficient", "[", 
       RowBox[{"ss", ",", "i"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ORDH"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yh", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"hh", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ORDH"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "eqsH", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "yh", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seriesH", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"eqsH", ",", "yh"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seriesH", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"seriesH", ",", "ruleH"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "h", "]"}]}], "Input",
 CellChangeTimes->{{3.5618071206661935`*^9, 3.5618071493501935`*^9}, {
   3.5618082886001935`*^9, 3.5618082926001935`*^9}, {3.5618085080671935`*^9, 
   3.5618085106771936`*^9}, {3.5618085504401937`*^9, 
   3.5618085676041937`*^9}, {3.5618086529261937`*^9, 
   3.5618086539011936`*^9}, {3.5618087476001935`*^9, 
   3.5618087621621933`*^9}, {3.5618106115351934`*^9, 3.561810613109194*^9}, {
   3.5618111484941936`*^9, 3.5618111654171934`*^9}, {3.5618115785341935`*^9, 
   3.561811579274194*^9}, {3.561828214234*^9, 3.561828244185*^9}, 
   3.561828850682*^9, {3.5618291366689997`*^9, 3.5618291368450003`*^9}, {
   3.5619037032125783`*^9, 3.561903741808978*^9}, {3.5619044257891784`*^9, 
   3.5619044380265784`*^9}, {3.5619044756197786`*^9, 
   3.5619044890131783`*^9}, {3.5619058079507785`*^9, 
   3.5619058280269785`*^9}, {3.5619119491083784`*^9, 
   3.5619119517003784`*^9}, {3.561911983216378*^9, 3.5619119854503784`*^9}, {
   3.561912020388378*^9, 3.5619120224743786`*^9}, {3.5619123437813787`*^9, 
   3.561912343942378*^9}, {3.5619138726043787`*^9, 3.5619138754963784`*^9}, 
   3.561913996730378*^9, {3.5619142430043783`*^9, 3.5619142461393785`*^9}, {
   3.5619145349823785`*^9, 3.5619145363343782`*^9}, {3.561915179803378*^9, 
   3.5619151804933786`*^9}, 3.5619217443761787`*^9, {3.5619218706515784`*^9, 
   3.5619218709167786`*^9}, 3.5619232661033783`*^9, {3.5619236009261785`*^9, 
   3.5619236011913786`*^9}, {3.5619236375943785`*^9, 
   3.5619236377659783`*^9}, {3.5619242533239784`*^9, 
   3.5619242535839787`*^9}, {3.5619246477899785`*^9, 
   3.5619246479279785`*^9}, {3.5619247074359784`*^9, 3.561924707622978*^9}, {
   3.5619247541719785`*^9, 3.5619247563199787`*^9}, {3.5619247969189787`*^9, 
   3.561924905596978*^9}, {3.5619249615529785`*^9, 3.561924961782978*^9}, {
   3.5619250012889786`*^9, 3.5619250385879784`*^9}, {3.5619251638569784`*^9, 
   3.5619252035777783`*^9}, {3.5619252760121784`*^9, 
   3.5619252952341785`*^9}, {3.5619254786891785`*^9, 3.561925494382778*^9}, {
   3.5619256187769785`*^9, 3.561925652992978*^9}, {3.5619257788263783`*^9, 
   3.5619258226623783`*^9}, {3.5619258683703785`*^9, 3.561925892285178*^9}, {
   3.5619260342953787`*^9, 3.5619260522041783`*^9}, 3.5619890599098525`*^9, {
   3.5619893475478525`*^9, 3.5619893514758525`*^9}, {3.5619894787938523`*^9, 
   3.5619894887268524`*^9}, {3.5619896740308523`*^9, 
   3.5619896742338524`*^9}, {3.5619898030978527`*^9, 3.561989836301852*^9}, {
   3.561989891138852*^9, 3.5619899137018523`*^9}, {3.561989966926852*^9, 
   3.5619900191428523`*^9}, {3.5619903109088526`*^9, 
   3.5619903137338524`*^9}, {3.561990349810852*^9, 3.561990412440852*^9}, {
   3.5619905471498528`*^9, 3.5619905650668526`*^9}, {3.5619907988328524`*^9, 
   3.561990801374852*^9}, {3.561991235185852*^9, 3.5619912673048525`*^9}, 
   3.5619913362228527`*^9, {3.5619913965508523`*^9, 3.5619914195738525`*^9}, {
   3.5619914910038524`*^9, 3.5619915336028523`*^9}, {3.5619918811778526`*^9, 
   3.5619918818928523`*^9}, {3.561992095709852*^9, 3.5619920959058523`*^9}, {
   3.5619922444648523`*^9, 3.5619922448398523`*^9}, {3.561998080035*^9, 
   3.561998094409*^9}, {3.5619981269960003`*^9, 3.561998128137*^9}, {
   3.561998459936*^9, 3.561998461929*^9}, {3.562018731792*^9, 
   3.562018735281*^9}, {3.5621450373810797`*^9, 3.5621450422530794`*^9}, {
   3.5621546107098*^9, 3.5621546116888*^9}, {3.5621587129282*^9, 
   3.5621587152872*^9}, {3.5621588529062*^9, 3.5621588563622*^9}, {
   3.562162380788*^9, 3.562162386459*^9}, {3.562165152124*^9, 
   3.562165185208*^9}, {3.5628672803258934`*^9, 3.562867282626893*^9}, {
   3.562871482151893*^9, 3.562871490902893*^9}, {3.562876301928893*^9, 
   3.5628763047388935`*^9}, {3.562876727586893*^9, 3.5628767336658936`*^9}, {
   3.5628783742948933`*^9, 3.562878376749893*^9}, {3.5865019544868875`*^9, 
   3.5865019846780195`*^9}, {3.58650243048077*^9, 3.586502430611859*^9}, {
   3.5865026333050776`*^9, 3.586502633426158*^9}, {3.5865028353418508`*^9, 
   3.586502841873212*^9}, {3.5865028856634245`*^9, 3.5865028957921834`*^9}, {
   3.586502955607085*^9, 3.586502957260186*^9}, {3.5865037287392387`*^9, 
   3.58650372962683*^9}, {3.586505070504323*^9, 3.5865050706224017`*^9}, 
   3.58650514035592*^9, {3.5865065339625864`*^9, 3.58650653419374*^9}, {
   3.586516522206687*^9, 3.586516522878134*^9}, {3.586517003307591*^9, 
   3.586517011831277*^9}, {3.586517449477374*^9, 3.586517452119238*^9}, {
   3.5865198050878973`*^9, 3.586519805627257*^9}, {3.5865199642570744`*^9, 
   3.5865199684088492`*^9}, {3.5865200624615903`*^9, 3.58652006271776*^9}, {
   3.586521287173133*^9, 3.586521287256187*^9}, {3.5865216449858284`*^9, 
   3.5865216451449294`*^9}, {3.5865217909882236`*^9, 3.586521791277416*^9}, {
   3.586522268784959*^9, 3.58652226935334*^9}, {3.586596375463258*^9, 
   3.5865963756113586`*^9}, {3.586596594228188*^9, 3.5865965987512054`*^9}, {
   3.5865995334984374`*^9, 3.586599534214917*^9}, {3.5866007099992723`*^9, 
   3.586600710871855*^9}, {3.5866013178797855`*^9, 3.5866013180659103`*^9}, {
   3.586603050666773*^9, 3.586603050774843*^9}, {3.5866174299805517`*^9, 
   3.5866174316906953`*^9}, {3.5866182295619464`*^9, 
   3.5866182296349955`*^9}, {3.5866182777861176`*^9, 3.586618277910204*^9}, {
   3.5866183531754093`*^9, 3.586618353519639*^9}, {3.58661857298204*^9, 
   3.5866185741538258`*^9}, {3.5866191577451334`*^9, 3.586619157875223*^9}, {
   3.586687255099452*^9, 3.586687255422666*^9}, {3.5866893477581635`*^9, 
   3.5866893564849863`*^9}, {3.5866899059355555`*^9, 
   3.5866899137787886`*^9}, {3.5866899732504616`*^9, 3.586689973553661*^9}, {
   3.5866911021166677`*^9, 3.586691105546957*^9}, {3.58669115332283*^9, 
   3.58669115350095*^9}, {3.5866913715013747`*^9, 3.586691399424001*^9}, {
   3.5866922317852654`*^9, 3.5866922319403687`*^9}, {3.586692279964407*^9, 
   3.586692295134527*^9}, {3.5866923545431557`*^9, 3.5866923712412977`*^9}, {
   3.5866924266762776`*^9, 3.586692445724985*^9}, {3.5866927917238007`*^9, 
   3.586692792668429*^9}, {3.586693069679221*^9, 3.586693077902707*^9}, {
   3.586694142748056*^9, 3.586694144827443*^9}, {3.586694548503871*^9, 
   3.58669454860794*^9}, {3.5866954165293713`*^9, 3.586695416889608*^9}, {
   3.5866956842019334`*^9, 3.5866956883567023`*^9}, {3.58669598434984*^9, 
   3.5866959846550455`*^9}, {3.5866960168515234`*^9, 
   3.5866960170426507`*^9}, {3.586697889615588*^9, 3.586697889941806*^9}, {
   3.5867020699692745`*^9, 3.586702070167407*^9}, {3.5867021309059258`*^9, 
   3.586702132179778*^9}, {3.5867045584176607`*^9, 3.586704566393982*^9}, {
   3.586704967070483*^9, 3.586704967355674*^9}, {3.5867050528877287`*^9, 
   3.586705053831358*^9}, {3.586705392515533*^9, 3.5867053931369457`*^9}, {
   3.586705463224701*^9, 3.5867054633768034`*^9}, {3.586705649335856*^9, 
   3.58670564971711*^9}, {3.586706653394925*^9, 3.58670666041562*^9}, {
   3.586707655024106*^9, 3.58670765586867*^9}, {3.586709245725996*^9, 
   3.5867092557706957`*^9}, {3.5867092941442947`*^9, 3.586709317606944*^9}, {
   3.586709462529623*^9, 3.586709469668388*^9}, 3.5867793380454865`*^9, {
   3.586779767479998*^9, 3.586779767682132*^9}, {3.5867905602496758`*^9, 
   3.5867905604287972`*^9}, {3.5872006248835526`*^9, 
   3.5872006249515977`*^9}, {3.5872069177218833`*^9, 
   3.5872069178719826`*^9}, {3.587207841316823*^9, 3.587207841418892*^9}, {
   3.5872174748585587`*^9, 3.5872174749776382`*^9}, {3.5873746824039*^9, 
   3.587374683111369*^9}, {3.5873757221301565`*^9, 3.5873757225544395`*^9}, {
   3.587377836787747*^9, 3.5873778678374224`*^9}, {3.587379620661471*^9, 
   3.5873796267195044`*^9}, {3.5874699429842205`*^9, 3.587469943050262*^9}, {
   3.5874717102764397`*^9, 3.587471710958894*^9}, {3.6041451457300725`*^9, 
   3.6041451669951954`*^9}, {3.6041452177999325`*^9, 3.604145218220215*^9}, {
   3.6041457062042837`*^9, 3.604145733817621*^9}, {3.604145780701757*^9, 
   3.604145782698083*^9}, 3.604145878322587*^9, {3.6041463558627253`*^9, 
   3.604146377100833*^9}, 3.6041476554687953`*^9, {3.6041477003175817`*^9, 
   3.604147724192435*^9}, {3.604147817692528*^9, 3.604147842316881*^9}, 
   3.6041478773021154`*^9, {3.604149301780115*^9, 3.6041493020132685`*^9}, {
   3.6041524582505093`*^9, 3.6041524590310235`*^9}, {3.60415548675629*^9, 
   3.6041554928193145`*^9}, 3.6041556085441723`*^9, 3.6042339742405705`*^9, {
   3.604234047488215*^9, 3.6042340476152983`*^9}, {3.604234160005938*^9, 
   3.6042341602360926`*^9}, {3.60423430208029*^9, 3.6042343026186476`*^9}, {
   3.6042349877386365`*^9, 3.6042350191655087`*^9}, 3.604235214171012*^9, {
   3.6042353114516144`*^9, 3.604235312096043*^9}, {3.6043007426547766`*^9, 
   3.6043007427568426`*^9}, {3.6043023302761164`*^9, 
   3.6043023310196114`*^9}, {3.604304885340948*^9, 3.6043048854800377`*^9}, {
   3.604305408661484*^9, 3.6043054188452473`*^9}, {3.6043128591591187`*^9, 
   3.604312859893607*^9}, {3.6043141478017955`*^9, 3.6043141497821107`*^9}, {
   3.604322940350919*^9, 3.604322943983328*^9}, {3.604323281620555*^9, 
   3.604323296449403*^9}, {3.604325126443428*^9, 3.604325138489428*^9}, {
   3.6043271601340456`*^9, 3.6043271609776077`*^9}, {3.6043881159135127`*^9, 
   3.604388157595194*^9}, {3.6043882647193327`*^9, 3.6043882655568895`*^9}, {
   3.6043904482974577`*^9, 3.604390448443555*^9}, {3.6043913639395337`*^9, 
   3.604391364871152*^9}, {3.6043986952500124`*^9, 3.6043986967029743`*^9}, {
   3.604399481580216*^9, 3.6043994830211754`*^9}, {3.604400790947768*^9, 
   3.6044007923817244`*^9}, {3.6044051089533844`*^9, 
   3.6044051134944005`*^9}, {3.60443443990784*^9, 3.6044344409680004`*^9}, {
   3.60444121708857*^9, 3.6044412180201902`*^9}, {3.605090458025893*^9, 
   3.605090474912778*^9}, 3.605090506514701*^9, 3.6050906005263433`*^9, 
   3.605090883821252*^9, {3.605091352471031*^9, 3.6050913607062073`*^9}, {
   3.605091778042088*^9, 3.605091778123398*^9}, {3.615114012038868*^9, 
   3.615114088645808*^9}, {3.615123014825604*^9, 3.615123017397447*^9}, 
   3.615129370779769*^9, 3.6297830092951393`*^9, {3.7503310064268713`*^9, 
   3.750331009429614*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1309358a-dc30-4371-83d0-4d20ae999983"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Series infinity (this can take some time)", "Subsubsection",
 CellChangeTimes->{{3.570966755519796*^9, 3.570966761972165*^9}, {
  3.604392077833144*^9, 
  3.604392088411169*^9}},ExpressionUUID->"4835d092-2012-41ee-9fac-\
d6d7c0b6653d"],

Cell["\<\
Here we do the standard series expansion at infinity. Again the order is \
arbitrary, but a high number of term might be needed to achieve numerical \
stability.\
\>", "Text",
 CellChangeTimes->{{3.571076995821969*^9, 3.57107704804386*^9}, {
  3.6043906123644085`*^9, 3.6043906612949033`*^9}, {3.615123035799006*^9, 
  3.615123038213965*^9}, {3.750331037492408*^9, 
  3.7503310422926397`*^9}},ExpressionUUID->"a41c2f5c-c1f1-4c59-b12f-\
6c96e23470d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ORDINF", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqSinf", "=", "eqS"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", "r_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hhinf", "[", "i", "]"}], 
      SuperscriptBox["r", 
       RowBox[{"-", "i"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"ORDINF", "+", "10"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleINF", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["k", "2"], "\[Rule]", 
      SuperscriptBox["kinf", "2"]}], ",", 
     RowBox[{
      SuperscriptBox["k", "4"], "\[Rule]", 
      SuperscriptBox["kinf", "4"]}], ",", 
     RowBox[{
      SuperscriptBox["k", "6"], "\[Rule]", 
      SuperscriptBox["kinf", "6"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ss1", "=", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "eqSinf", "}"}], "//.", "ruleINF"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Infinity]", ",", "ORDINF"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"SeriesCoefficient", "[", 
       RowBox[{
        RowBox[{"ss1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "i"}], "]"}], "\[Equal]", "0"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "ORDINF"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yinf", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"hhinf", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ORDINF", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "eqs1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "yinf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systINF1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"eqs1", ",", "yinf"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"h", ",", "R"}], "]"}]}], "Input",
 CellChangeTimes->{{3.570966765982394*^9, 3.5709668132310967`*^9}, {
   3.5709668639779997`*^9, 3.5709668999010544`*^9}, {3.570966960997549*^9, 
   3.5709669654828053`*^9}, {3.5709670329026613`*^9, 3.57096704389229*^9}, {
   3.5709774805542326`*^9, 3.5709774823793373`*^9}, {3.5709781414900365`*^9, 
   3.570978143492151*^9}, {3.570978525489*^9, 3.5709785256620097`*^9}, {
   3.570979576271101*^9, 3.570979576404109*^9}, {3.570981423626764*^9, 
   3.570981424295802*^9}, {3.570981896155791*^9, 3.5709818963408017`*^9}, {
   3.5709836595196495`*^9, 3.5709836597066603`*^9}, {3.570985134697025*^9, 
   3.570985134910037*^9}, {3.571163299642975*^9, 3.571163301032055*^9}, {
   3.5711634871096973`*^9, 3.5711634874007144`*^9}, {3.5711635488742304`*^9, 
   3.5711635517783966`*^9}, {3.571163939312562*^9, 3.571163941845707*^9}, {
   3.571220844653939*^9, 3.571220845189969*^9}, {3.5712219162522306`*^9, 
   3.571221916800262*^9}, {3.5712257247170625`*^9, 3.571225724974077*^9}, {
   3.5712301355811567`*^9, 3.5712301361351595`*^9}, {3.572780576467807*^9, 
   3.5727806145049825`*^9}, {3.5727807794364157`*^9, 
   3.5727807795904245`*^9}, {3.5738026991310115`*^9, 3.573802718079676*^9}, {
   3.573834287990802*^9, 3.573834288172923*^9}, {3.575667508362262*^9, 
   3.575667551280251*^9}, {3.575672933840489*^9, 3.575672934365439*^9}, {
   3.6041480885153875`*^9, 3.6041480953389254`*^9}, {3.6041481460596027`*^9, 
   3.6041481728183684`*^9}, {3.604148236760833*^9, 3.6041482686370053`*^9}, {
   3.604149451851776*^9, 3.6041494973489943`*^9}, {3.60415040556014*^9, 
   3.604150407304295*^9}, {3.604151363052829*^9, 3.604151363407067*^9}, {
   3.6041524816120214`*^9, 3.6041524828358335`*^9}, {3.604154746025372*^9, 
   3.6041547461484528`*^9}, {3.6041556742388*^9, 3.604155674918251*^9}, {
   3.604231405364071*^9, 3.6042314164504337`*^9}, {3.6042314517398667`*^9, 
   3.6042314524843636`*^9}, {3.604231495097661*^9, 3.604231537387748*^9}, {
   3.6042316009899864`*^9, 3.604231647084598*^9}, {3.604231677946093*^9, 
   3.604231684914721*^9}, {3.6042349961552277`*^9, 3.604235015563115*^9}, 
   3.6042352190412464`*^9, {3.604235315701438*^9, 3.6042353163308554`*^9}, {
   3.604300748014333*^9, 3.604300750108724*^9}, {3.6043023360859766`*^9, 
   3.60430233729478*^9}, {3.6043057368314204`*^9, 3.6043057388967915`*^9}, {
   3.604307212184211*^9, 3.6043072125894794`*^9}, 3.6043128642905273`*^9, {
   3.604314187854398*^9, 3.6043141889701385`*^9}, {3.604322960284154*^9, 
   3.604322962152394*^9}, {3.6043230054911785`*^9, 3.604323008565219*^9}, {
   3.6043233218642826`*^9, 3.6043233264923563`*^9}, {3.6043233609282255`*^9, 
   3.604323413180927*^9}, {3.604323475492305*^9, 3.6043235040432673`*^9}, {
   3.6043251418526583`*^9, 3.6043251439010253`*^9}, 3.604327168602676*^9, {
   3.604390443191062*^9, 3.6043904574215126`*^9}, {3.6043926063751507`*^9, 
   3.604392607709035*^9}, {3.6043987179110613`*^9, 3.604398721938734*^9}, {
   3.604399496054829*^9, 3.604399496744286*^9}, {3.604400824836276*^9, 
   3.6044008249393444`*^9}, {3.6044008597584653`*^9, 
   3.6044008649839334`*^9}, {3.604405138040702*^9, 3.604405138487999*^9}, {
   3.604434448262924*^9, 3.604434449401679*^9}, 3.6050911682753773`*^9, {
   3.605091783757018*^9, 3.60509178392048*^9}, {3.615114110222684*^9, 
   3.615114133861053*^9}, {3.6151141865078707`*^9, 3.6151142456352262`*^9}, {
   3.6151142969413567`*^9, 3.615114321177791*^9}, {3.615114511695737*^9, 
   3.615114516481132*^9}, {3.615114558969192*^9, 3.615114559773292*^9}, {
   3.615123025103492*^9, 3.615123025208501*^9}, 3.629783014582115*^9, {
   3.750331024885783*^9, 3.750331025932555*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"c4e3dff6-0b0a-42a4-be77-029cf8d22206"],

Cell["\<\
This is needed to extract the coefficients of the asymptotic expansion at \
infinity with enough precision.\
\>", "Text",
 CellChangeTimes->{{3.5710771408231983`*^9, 
  3.5710771665108023`*^9}},ExpressionUUID->"a3ee68f1-7499-40d2-a3fa-\
ce8664751a07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rs", "[", "r_", "]"}], ":=", 
   RowBox[{"r", "+", 
    RowBox[{"M", " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "-", "rp"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"r", "-", "rm"}], ")"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["M", "2"]}], "-", 
       SuperscriptBox["Q", "2"]}], 
      RowBox[{"2", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["M", "2"], "-", 
         SuperscriptBox["Q", "2"]}]]}]], " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"r", "-", "rp"}], 
       RowBox[{"r", "-", "rm"}]], "]"}]}]}]}], ";", 
  RowBox[{"Qinf", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "k", " ", 
          RowBox[{"rs", "[", "r", "]"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"hhinf", "[", "i", "]"}], 
           SuperscriptBox["r", "i"]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"ORDINF", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "//.", 
      RowBox[{"Union", "[", 
       RowBox[{"systINF1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"hhinf", "[", "0", "]"}], "\[Rule]", "Ain"}], ",", 
          RowBox[{"k", "\[Rule]", " ", 
           RowBox[{"-", "kinf"}]}]}], "}"}]}], "]"}]}], ")"}], "+", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "k", " ", 
          RowBox[{"rs", "[", "r", "]"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"hhinf", "[", "i", "]"}], 
           SuperscriptBox["r", "i"]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"ORDINF", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "//.", 
      RowBox[{"Union", "[", 
       RowBox[{"systINF1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"hhinf", "[", "0", "]"}], "\[Rule]", "Aout"}], ",", 
          RowBox[{"k", "\[Rule]", "kinf"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qpinf", "=", 
    RowBox[{"D", "[", 
     RowBox[{"Qinf", ",", "r"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solBC", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Qinf", "/.", 
           RowBox[{"r", "\[Rule]", "INF1"}]}], ")"}], "\[Equal]", "Y1"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Qpinf", "/.", 
           RowBox[{"r", "\[Rule]", "INF1"}]}], ")"}], "\[Equal]", "Y1p"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Ain", ",", "Aout"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5709001797049837`*^9, 3.570900391008113*^9}, {
   3.570900971607518*^9, 3.570901015285887*^9}, {3.570901054833976*^9, 
   3.570901175682776*^9}, 3.570902173441669*^9, {3.570903065146721*^9, 
   3.57090307454687*^9}, {3.5709034769845247`*^9, 3.5709035000172462`*^9}, {
   3.570904689522017*^9, 3.5709047059532423`*^9}, {3.5709238767542877`*^9, 
   3.5709238796747503`*^9}, {3.570924042566063*^9, 3.570924054130848*^9}, {
   3.570924998231529*^9, 3.5709249994162397`*^9}, {3.5709250642003307`*^9, 
   3.5709250645855293`*^9}, {3.5709671767168875`*^9, 3.5709673377440977`*^9}, 
   3.570990290024065*^9, {3.5727808020237083`*^9, 3.5727808985032263`*^9}, {
   3.572781155659935*^9, 3.5727811602781987`*^9}, 3.573803859191084*^9, {
   3.6041493391329255`*^9, 3.604149367927045*^9}, {3.604149570800774*^9, 
   3.6041495791483145`*^9}, {3.6041505216182117`*^9, 
   3.6041505234013987`*^9}, {3.604154668910158*^9, 3.604154671673992*^9}, {
   3.604154751526024*^9, 3.604154752790865*^9}, {3.6042317022392254`*^9, 
   3.6042317733024173`*^9}, {3.604323017787342*^9, 3.6043230219781246`*^9}, {
   3.604323541646237*^9, 3.604323561743585*^9}, {3.604327171496595*^9, 
   3.6043271730116005`*^9}, {3.6043292847800303`*^9, 3.60432930091875*^9}, {
   3.604329909077834*^9, 3.6043299106238637`*^9}, {3.6044344721951156`*^9, 
   3.604434485442067*^9}, {3.615114275690866*^9, 3.615114279314237*^9}, {
   3.6151143253929768`*^9, 3.6151143947654676`*^9}, {3.615114546750174*^9, 
   3.615114547961548*^9}, 3.629783301716151*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"2bd70886-3584-435f-a04d-6ac585046c5f"],

Cell["We store the equations to save time in future :", "Text",
 CellChangeTimes->{{3.604391063309883*^9, 
  3.604391068112072*^9}},ExpressionUUID->"29373722-b6b9-459b-9b3c-\
ce9a866cc29c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateDirectory", "[", "\"\<auxiliary_files\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "systINF1", ",", "ORDINF", ",", "seriesH", ",", "ORDH", ",", "eqn", ",", 
     "solBC"}], "}"}], ",", "\"\<auxiliary_files/series_SR_charged.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DumpSave", "[", 
     RowBox[{"\"\<series_super.mx\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "systINF1", ",", "ORDINF", ",", "seriesH", ",", "ORDH", ",", "eqn", 
        ",", "solBC"}], "}"}]}], "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.604391087604018*^9, 3.604391146841359*^9}, {
  3.6043912888026366`*^9, 3.6043912901385217`*^9}, {3.605090818447584*^9, 
  3.60509085413449*^9}, {3.6050909901590357`*^9, 3.605090991857882*^9}, {
  3.605091028609099*^9, 3.605091028807773*^9}, {3.6151145839341803`*^9, 
  3.61511458611874*^9}, {3.6151230821568336`*^9, 3.615123109688508*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"5c56c704-1cb2-4dd3-ac7b-794b72b7ab67"],

Cell[BoxData[
 TemplateBox[{
  "CreateDirectory","filex",
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/soham/.julia/v0.6/ScalarWave/test/\
Superradiance/auxiliary_files\\\\\\\"\\\"}]\\) already exists.\"",2,56,1,
   21329412045666410123,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6297833086881*^9, 3.7503313545358677`*^9, 
  3.750373483215613*^9, 3.7506053531548243`*^9, 3.7508108069705877`*^9, 
  3.7508109799102907`*^9, 3.751288850941104*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"3094b161-e2d2-4a6f-98e1-305b0d04541e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrator", "Subsection",
 CellChangeTimes->{{3.5688159179286947`*^9, 
  3.568815923463686*^9}},ExpressionUUID->"025a5db3-2d65-41eb-a111-\
17fe0c069e8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ext", "=", 
   RowBox[{"Get", "[", "\"\<auxiliary_files/series_SR_charged.m\>\"", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"systINF1", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ORDINF", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seriesH", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ORDH", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solBC", "=", 
   RowBox[{"ext", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6043912193975425`*^9, 3.6043912310172586`*^9}, {
   3.6050909371243134`*^9, 3.605091056136127*^9}, {3.605091200782514*^9, 
   3.605091200897448*^9}, {3.615114590432004*^9, 3.615114591406008*^9}, 
   3.615114624323443*^9, {3.615123116432191*^9, 3.6151231165612803`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"9082254b-cfc0-4388-a296-f8759144fe8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"INT", "[", 
    RowBox[{
    "\[Omega]0_", ",", "l0_", ",", "m0_", ",", "Q0_", ",", "q0_", ",", "a0_", 
     ",", "s0_", ",", "EPS_", ",", "INF0_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ruleP", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AccuracyGoal", "\[Rule]", "80"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "12"}], ",", 
        RowBox[{"MaxSteps", "\[Rule]", 
         SuperscriptBox["10", "8"]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"param", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Omega]", "\[Rule]", "\[Omega]0"}], ",", 
        RowBox[{"l", "\[Rule]", "l0"}], ",", 
        RowBox[{"m", "\[Rule]", " ", "m0"}], ",", 
        RowBox[{"a", "\[Rule]", " ", "a0"}], ",", 
        RowBox[{"s", "\[Rule]", " ", "s0"}], ",", 
        RowBox[{
         RowBox[{"hh", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
        RowBox[{"q", "\[Rule]", "q0"}], ",", 
        RowBox[{"Q", "\[Rule]", "Q0"}], ",", 
        RowBox[{"M", "\[Rule]", "1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "Integration", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rh", "=", 
      RowBox[{"rp", "//.", "param"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rhn", "=", 
      RowBox[{"rh", 
       RowBox[{"(", 
        RowBox[{"1", "+", "EPS"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"INF", "=", 
      RowBox[{
       FractionBox["INF0", "\[Omega]"], "//.", "param"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Psi]g", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", "kH", " ", 
          RowBox[{"rs", "[", "r", "]"}]}], "]"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"hh", "[", "i", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"r", "-", "rp"}], ")"}], "i"]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "ORDH"}], "}"}]}], "]"}]}], "//.", 
       RowBox[{"Union", "[", 
        RowBox[{"param", ",", "seriesH"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BCs", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]", "[", "rhn", "]"}], "\[Equal]", "\[Psi]g"}], "/.", 
          RowBox[{"r", "\[Rule]", "rhn"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]", "'"}], "[", "rhn", "]"}], "\[Equal]", 
           RowBox[{"D", "[", 
            RowBox[{"\[Psi]g", ",", "r"}], "]"}]}], "/.", 
          RowBox[{"r", "\[Rule]", "rhn"}]}]}], "}"}], "//.", "param"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"EQs", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eqn", "\[Equal]", "0"}], "}"}], "//.", "param"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"EQs", ",", "BCs"}], "]"}], ",", 
        RowBox[{"\[Psi]", "[", "r", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "rhn", ",", "INF"}], "}"}], ",", "ruleP"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Psi]n", "=", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "r", "]"}], "/.", 
       RowBox[{"sol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Psi]pn", "=", 
      RowBox[{"D", "[", 
       RowBox[{"\[Psi]n", ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "***)"}], "\[IndentingNewLine]", 
     RowBox[{"Ainn", "=", 
      RowBox[{"Ain", "//.", 
       RowBox[{"Union", "[", 
        RowBox[{"solBC", ",", "param", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r", "\[Rule]", " ", "INF"}], ",", 
           RowBox[{"INF1", "\[Rule]", " ", "INF"}], ",", 
           RowBox[{"Y1", "\[Rule]", " ", "\[Psi]n"}], ",", 
           RowBox[{"Y1p", "\[Rule]", " ", "\[Psi]pn"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Aoutn", "=", 
      RowBox[{"Aout", "//.", 
       RowBox[{"Union", "[", 
        RowBox[{"solBC", ",", "param", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r", "\[Rule]", " ", "INF"}], ",", 
           RowBox[{"INF1", "\[Rule]", " ", "INF"}], ",", 
           RowBox[{"Y1", "\[Rule]", " ", "\[Psi]n"}], ",", 
           RowBox[{"Y1p", "\[Rule]", " ", "\[Psi]pn"}]}], "}"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Amplification", " ", "Factors"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Abs", "[", "Aoutn", "]"}], 
          RowBox[{"Abs", "[", "Ainn", "]"}]], ")"}], "2"], "//.", "param"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Z", "-", "1"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.568815925825301*^9, 3.5688161483405037`*^9}, {
   3.568816240618835*^9, 3.5688162407475443`*^9}, {3.569742897480089*^9, 
   3.5697428986551294`*^9}, 3.569747799527301*^9, 3.569747919141142*^9, {
   3.5697527950070257`*^9, 3.569752795374047*^9}, {3.569753015358629*^9, 
   3.56975301590666*^9}, {3.570178892041976*^9, 3.570178908648926*^9}, {
   3.5701790689860964`*^9, 3.570179081366805*^9}, {3.570181843624797*^9, 
   3.5701818544424157`*^9}, {3.57018325791769*^9, 3.570183260941863*^9}, {
   3.5701834430232773`*^9, 3.5701834604202724`*^9}, {3.5727809537443857`*^9, 
   3.572780987461314*^9}, {3.572781039109268*^9, 3.5727810697070184`*^9}, {
   3.572781298177086*^9, 3.5727812997791777`*^9}, {3.5738026631529655`*^9, 
   3.573802692053281*^9}, {3.573832624210309*^9, 3.573832624903773*^9}, {
   3.6041488569427013`*^9, 3.604148955819363*^9}, {3.604148995029399*^9, 
   3.6041490174082623`*^9}, {3.6041490521263247`*^9, 3.604149154615382*^9}, {
   3.604149615891717*^9, 3.6041497551391964`*^9}, {3.6041498046260595`*^9, 
   3.6041498162597866`*^9}, {3.6041498536626205`*^9, 
   3.6041498556319313`*^9}, {3.604149893474065*^9, 3.604149938738121*^9}, {
   3.604149983186638*^9, 3.604149997069863*^9}, {3.6041500289660397`*^9, 
   3.604150029539425*^9}, {3.6041501008067493`*^9, 3.60415010964762*^9}, {
   3.604150162633808*^9, 3.6041501704960313`*^9}, {3.6041505873321924`*^9, 
   3.6041505972908077`*^9}, {3.604150869968893*^9, 3.6041508733131146`*^9}, {
   3.60415407298223*^9, 3.6041540793744802`*^9}, {3.6041545829549046`*^9, 
   3.6041545939021792`*^9}, {3.60415487822917*^9, 3.604154885562039*^9}, {
   3.6041550119299564`*^9, 3.6041551031735525`*^9}, {3.604155232403377*^9, 
   3.6041552325714893`*^9}, {3.604155354533484*^9, 3.6041553758126154`*^9}, {
   3.604155756005097*^9, 3.604155762511419*^9}, 3.6041558062354603`*^9, {
   3.604231799537841*^9, 3.6042318391411414`*^9}, {3.604232375130267*^9, 
   3.6042323785095105`*^9}, 3.6042324347998924`*^9, {3.604234352754942*^9, 
   3.604234364518756*^9}, {3.604234442347441*^9, 3.6042344505028567`*^9}, {
   3.6042345181167603`*^9, 3.6042345289039245`*^9}, {3.604234763692848*^9, 
   3.604234768735196*^9}, {3.60423533927009*^9, 3.6042353744134293`*^9}, {
   3.6042354153626223`*^9, 3.6042354405743666`*^9}, {3.604244557567128*^9, 
   3.6042446206019897`*^9}, {3.6042446664334264`*^9, 
   3.6042446688550377`*^9}, {3.6042451102230186`*^9, 
   3.6042451618573093`*^9}, {3.604245194286847*^9, 3.6042451983575535`*^9}, {
   3.604245396060848*^9, 3.6042454122706137`*^9}, {3.604245533411059*^9, 
   3.604245580983653*^9}, {3.6042456523110247`*^9, 3.6042456621305466`*^9}, {
   3.604245779816698*^9, 3.604245909316701*^9}, 3.6042459398809977`*^9, {
   3.6042461422143717`*^9, 3.6042461636846294`*^9}, {3.604301503232877*^9, 
   3.604301510145466*^9}, {3.604301738948418*^9, 3.6043017473299828`*^9}, {
   3.6043054635379257`*^9, 3.60430559139884*^9}, {3.604311609500486*^9, 
   3.6043116145148168`*^9}, {3.6043130903636627`*^9, 3.604313090844982*^9}, {
   3.6043133512409124`*^9, 3.6043133516271667`*^9}, {3.6043155844443645`*^9, 
   3.60431558879325*^9}, {3.6043239226452613`*^9, 3.6043239357259483`*^9}, 
   3.6043261400573516`*^9, {3.60432718085781*^9, 3.6043271951082726`*^9}, {
   3.6043288153472776`*^9, 3.6043288956836324`*^9}, {3.6043290604760685`*^9, 
   3.6043291969507036`*^9}, {3.604329355668028*^9, 3.6043293598177805`*^9}, {
   3.604329446605418*^9, 3.6043294478962765`*^9}, {3.6043294899241867`*^9, 
   3.604329530731287*^9}, {3.6043295757391777`*^9, 3.604329585084382*^9}, {
   3.6043296181763587`*^9, 3.604329656455779*^9}, {3.604329696235198*^9, 
   3.6043297343087664`*^9}, {3.6043298196214232`*^9, 3.604329832311853*^9}, {
   3.6043884345431137`*^9, 3.60438844683928*^9}, 3.604388528160283*^9, 
   3.6043886788693733`*^9, {3.604389566195649*^9, 3.6043897886123548`*^9}, {
   3.60438984451448*^9, 3.6043899251400223`*^9}, {3.604389970564191*^9, 
   3.604389983231604*^9}, {3.6043912476693172`*^9, 3.60439124801855*^9}, {
   3.604398886448985*^9, 3.604398890217493*^9}, {3.6043989718997335`*^9, 
   3.6043989753770432`*^9}, {3.6043998358054557`*^9, 3.604399920170484*^9}, {
   3.604399954714428*^9, 3.6043999726193123`*^9}, {3.6044000747121162`*^9, 
   3.604400076693431*^9}, 3.604400107122638*^9, 3.6044002169275618`*^9, {
   3.6050910774996357`*^9, 3.605091084635401*^9}, {3.605091280634385*^9, 
   3.6050912808952723`*^9}, {3.605091403835676*^9, 3.605091403951399*^9}, {
   3.615114663871642*^9, 3.615114876783677*^9}, {3.615115237226982*^9, 
   3.615115320911675*^9}, {3.6151153715153103`*^9, 3.615115375098234*^9}, {
   3.615115414768609*^9, 3.615115418448127*^9}, {3.615120100195694*^9, 
   3.615120104526572*^9}, {3.615120140884457*^9, 3.615120143812866*^9}, {
   3.750608591781273*^9, 3.750608657797654*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"f7f9521c-e25a-401e-a541-0af1d646e8ed"],

Cell["Choose l = 0, s = 0, \[Omega] = 1, M = 1 (default)", "Program",
 CellChangeTimes->{{3.750364076036442*^9, 
  3.750364099970607*^9}},ExpressionUUID->"68432cb1-81c1-4b3e-8f0f-\
17f71f8691b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"INT", "[", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"1", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}], ",", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", "3"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6050912862890167`*^9, 3.605091289019115*^9}, {
   3.6050914860291357`*^9, 3.605091575844922*^9}, {3.60509160849973*^9, 
   3.605091608741849*^9}, {3.605097982471449*^9, 3.605098013390587*^9}, 
   3.605098182065989*^9, {3.6050982777620077`*^9, 3.605098277889522*^9}, 
   3.605106868821073*^9, {3.605272637854561*^9, 3.6052727179330482`*^9}, {
   3.605273264918542*^9, 3.6052733183350267`*^9}, {3.615115281399601*^9, 
   3.615115301486348*^9}, {3.615115385370799*^9, 3.615115401252716*^9}, {
   3.6151154394468946`*^9, 3.615115440233172*^9}, {3.615115506746361*^9, 
   3.615115512052271*^9}, {3.615115688194957*^9, 3.615115691487515*^9}, {
   3.615116249940906*^9, 3.615116269964395*^9}, {3.6151163869381123`*^9, 
   3.61511640012999*^9}, 3.615116485382739*^9, {3.6151202257214823`*^9, 
   3.615120257421708*^9}, {3.6151208688427258`*^9, 3.615121025180221*^9}, {
   3.6151227224328403`*^9, 3.615122769284698*^9}, {3.6151292951042023`*^9, 
   3.615129333203824*^9}, {3.61513002434548*^9, 3.615130051764043*^9}, {
   3.6151301977686377`*^9, 3.615130200115601*^9}, {3.6151302365194397`*^9, 
   3.61513025352157*^9}, {3.615130301990196*^9, 3.615130336709918*^9}, 
   3.615130412094695*^9, {3.615176114236961*^9, 3.615176118457176*^9}, {
   3.629783324121078*^9, 3.629783329430401*^9}, {3.6297833637120733`*^9, 
   3.629783384964839*^9}, {3.750331595644261*^9, 3.750331606666012*^9}, {
   3.750332007769589*^9, 3.750332053329968*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"405c603b-557b-44b8-a2e6-8502e7c4a098"],

Cell[BoxData[
 RowBox[{"-", "0.999999999908249`"}]], "Output",
 CellChangeTimes->{
  3.6050912897562733`*^9, 3.605091427732263*^9, {3.6050914951253223`*^9, 
   3.605091579032853*^9}, 3.605091611560376*^9, {3.6050979691479187`*^9, 
   3.605098020443636*^9}, 3.605098188991371*^9, 3.605099785938458*^9, 
   3.605106877892318*^9, {3.605272655729589*^9, 3.6052727252649612`*^9}, {
   3.6052732771356907`*^9, 3.605273325278728*^9}, 3.6052734163250713`*^9, {
   3.615115303869475*^9, 3.615115344646698*^9}, {3.615115401767617*^9, 
   3.615115441356166*^9}, {3.6151155084234467`*^9, 3.6151155129965773`*^9}, {
   3.615115689569806*^9, 3.61511569252888*^9}, {3.615116252343306*^9, 
   3.615116270404907*^9}, {3.6151163876674433`*^9, 3.615116400530817*^9}, {
   3.615116483192275*^9, 3.6151164858422937`*^9}, 3.6151170521103*^9, 
   3.615120114055932*^9, {3.615120238083687*^9, 3.6151202584293537`*^9}, {
   3.6151208696194677`*^9, 3.615121027667294*^9}, {3.615122725526559*^9, 
   3.6151227723331747`*^9}, 3.615123518612821*^9, {3.615129312759351*^9, 
   3.615129334342256*^9}, 3.615129975482956*^9, {3.615130020942355*^9, 
   3.6151300544258413`*^9}, {3.615130198850615*^9, 3.6151302016453447`*^9}, {
   3.6151302379313793`*^9, 3.615130254921503*^9}, {3.6151302972871237`*^9, 
   3.615130338171867*^9}, 3.615130413600271*^9, 3.615176126165579*^9, 
   3.6297832025856524`*^9, {3.629783313690544*^9, 3.62978333005646*^9}, {
   3.629783364150625*^9, 3.629783389068863*^9}, 3.7503313593608932`*^9, 
   3.750331608084235*^9, {3.7503320108051167`*^9, 3.750332054869678*^9}, 
   3.750373484714148*^9, 3.750605354840344*^9, {3.7506085966927958`*^9, 
   3.750608663585881*^9}, 3.750810807946851*^9, 3.750810981279791*^9, 
   3.7512884759714117`*^9, 3.751288852479966*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"bf3f2413-4522-41ab-a4a0-032df89a10aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", "\[Psi]n", "]"}], ",", 
       RowBox[{"Im", "[", "\[Psi]n", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "rmin", ",", 
       RowBox[{"rmin", "+", "10"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"rmin", ",", " ", "2.1", ",", " ", "100"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7503317718535547`*^9, 3.7503317951011353`*^9}, {
  3.750331846618664*^9, 3.7503319414871693`*^9}, {3.750331986662148*^9, 
  3.7503319867285967`*^9}, {3.750332063326054*^9, 3.750332079232965*^9}, {
  3.7503321223714743`*^9, 3.750332167148522*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"f67f4cb9-7f3d-49b3-ad22-7e7c7ba724cd"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`rmin$$ = 2.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`rmin$$], 2.1, 100}}, Typeset`size$$ = {
    360., {105., 109.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`rmin$6177$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`rmin$$ = 2.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`rmin$$, $CellContext`rmin$6177$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[{
         Re[$CellContext`\[Psi]n], 
         Im[$CellContext`\[Psi]n]}, {$CellContext`r, $CellContext`rmin$$, \
$CellContext`rmin$$ + 10}], 
      "Specifications" :> {{$CellContext`rmin$$, 2.1, 100}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{405., {150., 156.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7503316206533527`*^9, {3.750331775434618*^9, 3.7503317956153316`*^9}, {
   3.7503318511110497`*^9, 3.7503318608891163`*^9}, {3.7503319021792307`*^9, 
   3.7503319419657784`*^9}, {3.7503319871069603`*^9, 3.750332079716144*^9}, {
   3.75033212387961*^9, 3.750332168481119*^9}, 3.7503734848670464`*^9, 
   3.750605355184724*^9, 3.7506086668728*^9, 3.750810808027939*^9, 
   3.750810981399823*^9, 3.7512888526859293`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"c73f7268-2c6c-4b7b-806e-fd61d91fda97"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\</Users/soham/Projects/ScalarWave/output/hdf5/collocation-points-r.\
h5\>\"", ",", " ", "\"\</collocation-points-grid\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\</Users/soham/Projects/ScalarWave/output/hdf5/values-for-julia-grid.\
h5\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Datasets\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<psi-real-grid\>\"", "  ", "\[Rule]", " ", 
           RowBox[{"Re", "[", 
            RowBox[{"\[Psi]n", "/.", 
             RowBox[{"r", "\[Rule]", "R"}]}], "]"}]}], ",", 
          RowBox[{"\"\<psi-imag-grid\>\"", "  ", "\[Rule]", " ", 
           RowBox[{"Im", "[", 
            RowBox[{"\[Psi]n", "/.", 
             RowBox[{"r", "\[Rule]", "R"}]}], "]"}]}]}], "}"}]}], ",", 
       RowBox[{"\"\<DataFormat\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}]}]}], "}"}], ",", 
     "\"\<Rules\>\""}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.750331625176858*^9, 3.7503316328650417`*^9}, {
   3.7503316667811327`*^9, 3.750331686834939*^9}, 3.750332309778067*^9, {
   3.750505897306563*^9, 3.750505918126993*^9}, {3.7505224292119904`*^9, 
   3.7505224389860973`*^9}, {3.7505407358275337`*^9, 3.750540841726804*^9}, {
   3.7505411663318644`*^9, 3.750541181459519*^9}, {3.750611860170402*^9, 
   3.750611860344907*^9}, {3.750613922153838*^9, 3.750613922798647*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"6d905197-85e8-4a30-aafe-9f37ae50dce8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.7503607629180593`*^9, {3.750362063344984*^9, 3.7503620954540567`*^9}, 
   3.750362226764032*^9, {3.750540849113674*^9, 3.750541063836831*^9}, {
   3.750541094637539*^9, 3.7505411035128927`*^9}, {3.750541190060574*^9, 
   3.750541208695303*^9}, {3.7505420261784477`*^9, 3.7505420291116962`*^9}, 
   3.7506118589481*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"d5febb9f-1efe-4f4f-9c9b-18c36795e48a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</Users/soham/Projects/ScalarWave/output/hdf5/collocation-points-for-\
mathematica.h5\>\"", ",", " ", "\"\</collocation-points\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\</Users/soham/Projects/ScalarWave/output/hdf5/values-for-julia.h5\>\"", 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Datasets\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<psi-real\>\"", "  ", "\[Rule]", " ", 
         RowBox[{"Re", "[", 
          RowBox[{"\[Psi]n", "/.", 
           RowBox[{"r", "\[Rule]", "R"}]}], "]"}]}], ",", 
        RowBox[{"\"\<psi-imag\>\"", "  ", "\[Rule]", " ", 
         RowBox[{"Im", "[", 
          RowBox[{"\[Psi]n", "/.", 
           RowBox[{"r", "\[Rule]", "R"}]}], "]"}]}]}], "}"}]}], ",", 
     RowBox[{"\"\<DataFormat\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}]}]}], "}"}], ",", 
   "\"\<Rules\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.7506053971087093`*^9, 3.750605441252384*^9}, {
  3.7506055964983873`*^9, 3.750605604540831*^9}, {3.75060572635843*^9, 
  3.750605728555444*^9}, {3.7506094292883883`*^9, 3.750609429438814*^9}, {
  3.7512888916976023`*^9, 3.751288898319558*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"56846f73-677d-495f-ae58-981c0248ef09"],

Cell[BoxData["\<\"/Users/soham/Projects/ScalarWave/output/hdf5/values-for-\
julia.h5\"\>"], "Output",
 CellChangeTimes->{
  3.750609430046618*^9, 3.750609604337058*^9, 3.750610419268587*^9, 
   3.7506106170165033`*^9, 3.750623571657913*^9, 3.750676056798365*^9, 
   3.750810809324278*^9, 3.750810983143901*^9, 3.751288854542207*^9, {
   3.751288888598111*^9, 3.751288907970089*^9}, 3.751289673655455*^9, 
   3.751290803388063*^9, 3.7512981665061827`*^9, 3.751302820172782*^9, 
   3.751303600227586*^9, 3.751303832437373*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"2998e390-139e-4666-b2ae-a50d88e88c77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Re", "[", 
  RowBox[{"\[Psi]n", "/.", 
   RowBox[{"r", "\[Rule]", "R"}]}], "]"}]], "Input",
 CellChangeTimes->{3.7512889105864*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"79ef3264-f9f9-46bb-ab29-29ca07f471d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9839043604313233`"}], ",", "0.8660080666757458`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.751288911062292*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"420723b7-e4aa-4ee9-8c47-8eff34a0a616"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1025, 570},
WindowMargins->{{42, Automatic}, {Automatic, 90}},
CellContext->Notebook,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 1040, 20, 75, "Subtitle",ExpressionUUID->"f58bf81e-dccc-4b3f-91c2-9a379a3b2025"],
Cell[1622, 44, 276, 7, 30, "Input",ExpressionUUID->"fbea81b3-95c1-4593-99f5-0aeab965045a"],
Cell[1901, 53, 298, 7, 30, "Input",ExpressionUUID->"d706f32d-4108-4795-b83d-ea58928e904e"],
Cell[CellGroupData[{
Cell[2224, 64, 407, 6, 67, "Section",ExpressionUUID->"e8a5b82e-6368-4394-9129-98c578762f0f"],
Cell[2634, 72, 570, 10, 58, "Text",ExpressionUUID->"91378cea-906e-44bc-98d5-2e8e03c5522c"],
Cell[CellGroupData[{
Cell[3229, 86, 259, 4, 54, "Subsection",ExpressionUUID->"568d008f-55d3-4a08-8fdc-ab98b09186d3"],
Cell[3491, 92, 3178, 92, 314, "Input",ExpressionUUID->"36589d43-89a9-40f5-8ad5-bb944dab06c9"],
Cell[6672, 186, 649, 20, 42, "Text",ExpressionUUID->"b3d25c19-0e9f-4ac6-beda-aeb026e471c5"],
Cell[7324, 208, 1176, 39, 138, "Input",ExpressionUUID->"28400796-6a76-46cd-80c6-02bc99921d44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8537, 252, 340, 8, 54, "Subsection",ExpressionUUID->"ed151953-4d2b-4bef-90d3-9b8be778124f"],
Cell[CellGroupData[{
Cell[8902, 264, 245, 4, 45, "Subsubsection",ExpressionUUID->"73ac825d-a349-4d5b-a4f4-a582ba27ca21"],
Cell[9150, 270, 1167, 33, 89, "Input",ExpressionUUID->"673ce1d2-e4e5-4ca1-8bc3-1324ff7e550e"],
Cell[10320, 305, 156, 3, 35, "Text",ExpressionUUID->"1aa09325-0354-4adb-907f-f1eeaf2745b9"],
Cell[10479, 310, 1455, 43, 128, "Input",ExpressionUUID->"1ae5b8f4-b930-411f-8f38-9d6ee42e8b9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11971, 358, 341, 5, 45, "Subsubsection",ExpressionUUID->"f078b389-1aaa-4edc-af11-74fc324044b2"],
Cell[12315, 365, 287, 6, 35, "Text",ExpressionUUID->"ccd756d5-58a2-47b7-b416-f8e42c7c7bd4"],
Cell[12605, 373, 12156, 207, 264, "Input",ExpressionUUID->"1309358a-dc30-4371-83d0-4d20ae999983"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24798, 585, 241, 4, 45, "Subsubsection",ExpressionUUID->"4835d092-2012-41ee-9fac-d6d7c0b6653d"],
Cell[25042, 591, 460, 9, 58, "Text",ExpressionUUID->"a41c2f5c-c1f1-4c59-b12f-6c96e23470d2"],
Cell[25505, 602, 6052, 126, 266, "Input",ExpressionUUID->"c4e3dff6-0b0a-42a4-be77-029cf8d22206"],
Cell[31560, 730, 261, 6, 35, "Text",ExpressionUUID->"a3ee68f1-7499-40d2-a3fa-ce8664751a07"],
Cell[31824, 738, 4708, 121, 216, "Input",ExpressionUUID->"2bd70886-3584-435f-a04d-6ac585046c5f"],
Cell[36535, 861, 189, 3, 35, "Text",ExpressionUUID->"29373722-b6b9-459b-9b3c-ce9a866cc29c"],
Cell[CellGroupData[{
Cell[36749, 868, 1241, 29, 94, "Input",ExpressionUUID->"5c56c704-1cb2-4dd3-ac7b-794b72b7ab67"],
Cell[37993, 899, 575, 12, 24, "Message",ExpressionUUID->"3094b161-e2d2-4a6f-98e1-305b0d04541e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38629, 918, 160, 3, 54, "Subsection",ExpressionUUID->"025a5db3-2d65-41eb-a111-17fe0c069e8a"],
Cell[38792, 923, 1416, 37, 178, "Input",ExpressionUUID->"9082254b-cfc0-4388-a296-f8759144fe8b"],
Cell[40211, 962, 9940, 197, 518, "Input",ExpressionUUID->"f7f9521c-e25a-401e-a541-0af1d646e8ed"],
Cell[50154, 1161, 195, 3, 50, "Program",ExpressionUUID->"68432cb1-81c1-4b3e-8f0f-17f71f8691b8"],
Cell[CellGroupData[{
Cell[50374, 1168, 1804, 29, 33, "Input",ExpressionUUID->"405c603b-557b-44b8-a2e6-8502e7c4a098"],
Cell[52181, 1199, 1834, 26, 34, "Output",ExpressionUUID->"bf3f2413-4522-41ab-a4a0-032df89a10aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54052, 1230, 801, 19, 30, "Input",ExpressionUUID->"f67f4cb9-7f3d-49b3-ad22-7e7c7ba724cd"],
Cell[54856, 1251, 2182, 42, 325, "Output",ExpressionUUID->"c73f7268-2c6c-4b7b-806e-fd61d91fda97"]
}, Open  ]],
Cell[57053, 1296, 1683, 37, 115, "Input",ExpressionUUID->"6d905197-85e8-4a30-aafe-9f37ae50dce8"],
Cell[58739, 1335, 448, 7, 30, "Input",ExpressionUUID->"d5febb9f-1efe-4f4f-9c9b-18c36795e48a"],
Cell[CellGroupData[{
Cell[59212, 1346, 1417, 33, 115, "Input",ExpressionUUID->"56846f73-677d-495f-ae58-981c0248ef09"],
Cell[60632, 1381, 603, 9, 34, "Output",ExpressionUUID->"2998e390-139e-4666-b2ae-a50d88e88c77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61272, 1395, 234, 5, 30, "Input",ExpressionUUID->"79ef3264-f9f9-46bb-ab29-29ca07f471d4"],
Cell[61509, 1402, 252, 6, 68, "Output",ExpressionUUID->"420723b7-e4aa-4ee9-8c47-8eff34a0a616"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

